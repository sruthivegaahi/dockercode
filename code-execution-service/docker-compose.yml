version: "3.8"

services:
  # Node.js API server (handles run, run-custom, submit requests)
  executor:
    build: ./docker/javascript
    container_name: code_executor
    volumes:
      - ./temp:/app/temp
      - ./src:/app/src
    ports:
      - "5000:5000"
    depends_on:
      - python_executor
      - java_executor
      - cpp_executor
    restart: always

  # Python executor container (used by Node server to run Python code)
  python_executor:
    build: ./docker/python
    container_name: python_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null  # Keep container running
    restart: always

  # Java executor container
  java_executor:
    build: ./docker/java
    container_name: java_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always

  # C++ executor container
  cpp_executor:
    build: ./docker/cpp
    container_name: cpp_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always

networks:
  default:
    name: code_execution_net
