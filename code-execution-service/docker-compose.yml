version: "3.9"

services:
  # Main Node.js server
  executor:
    build:
      context: .
      dockerfile: Dockerfile   # Starts the Node.js app
    container_name: executor
    volumes:
      - ./:/app              # Mount full project
      - ./temp:/app/temp     # Temp folder for code execution
      - /var/run/docker.sock:/var/run/docker.sock   # Allow access to Docker
    ports:
      - "5002:5002"
    restart: always
    command: ["node", "src/app.js"]

  # Python executor
  python_executor:
    build: ./docker/python
    container_name: python_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always

  # Java executor
  java_executor:
    build: ./docker/java
    container_name: java_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always

  # C++ executor
  cpp_executor:
    build: ./docker/cpp
    container_name: cpp_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always

  # JavaScript executor
  js_executor:
    build: ./docker/javascript
    container_name: js_executor
    volumes:
      - ./temp:/app/temp
    command: tail -f /dev/null
    restart: always
